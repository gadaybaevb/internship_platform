{% extends 'base.html' %}

{% block content %}
<div class="container mt-5">
    <h1>–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å <b>{{ request.user.full_name }},</b> –Ω–∞ –ø–ª–∞—Ç—Ñ–æ—Ä–º—É —Å—Ç–∞–∂–∏—Ä–æ–≤–æ–∫ –æ—Ç –∫–æ–º–ø–∞–Ω–∏–∏ ARKON</h1>
    <p>–ó–¥–µ—Å—å –≤—ã –º–æ–∂–µ—Ç–µ —É–ø—Ä–∞–≤–ª—è—Ç—å —Å–≤–æ–∏–º–∏ —Å—Ç–∞–∂–∏—Ä–æ–≤–∫–∞–º–∏, –ø—Ä–æ—Ö–æ–¥–∏—Ç—å —Ç–µ—Å—Ç—ã –∏ –æ—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å –ø—Ä–æ–≥—Ä–µ—Å—Å.</p>

    {% if request.user.role == 'admin' %}
        <h3>üìÖ –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∑–∞ –º–µ—Å—è—Ü</h3>
        <ul>
          <li>–ù–æ–≤—ã–µ —Å—Ç–∞–∂—ë—Ä—ã: <b>{{ interns_this_month }}</b></li>
          <li>–ù–æ–≤—ã–µ –º–µ–Ω—Ç–æ—Ä—ã: <b>{{ mentors_this_month }}</b></li>
        </ul>
        
        <h3>üìä –û–±—â–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</h3>
        <ul>
          <li>–í—Å–µ–≥–æ —Å—Ç–∞–∂—ë—Ä–æ–≤: <b>{{ total_interns }}</b></li>
          <li>–í—Å–µ–≥–æ –º–µ–Ω—Ç–æ—Ä–æ–≤: <b>{{ total_mentors }}</b></li>
          <li>–ü—Ä–æ–≥—Ä–µ—Å—Å –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤: <b>{{ total_completion_percent }}%</b></li>
        </ul>
        
        <h3>‚≠ê –°—Ç–∞–∂—ë—Ä –º–µ—Å—è—Ü–∞</h3>
        {% if intern_of_month %}
          <p>
            {{ intern_of_month.full_name }} ‚Äî {{ intern_of_month_percent }}%
          </p>
        {% else %}
          <p>–ü–æ–∫–∞ –Ω–µ—Ç –¥–∞–Ω–Ω—ã—Ö</p>
        {% endif %}

    {% elif request.user.role == 'mentor' %}
        <h3>üìÖ –ú–æ–π –º–µ—Å—è—Ü</h3>
        <ul>
          <li>–ù–æ–≤—ã–µ —Å—Ç–∞–∂—ë—Ä—ã: <b>{{ interns_this_month }}</b></li>
        </ul>
        
        <h3>üìä –û–±—â–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</h3>
        <ul>
          <li>–í—Å–µ–≥–æ —Å—Ç–∞–∂—ë—Ä–æ–≤: <b>{{ total_interns }}</b></li>
          <li>–°—Ä–µ–¥–Ω–∏–π –ø—Ä–æ–≥—Ä–µ—Å—Å: <b>{{ avg_completion_percent }}%</b></li>
        </ul>
        <h3>‚≠ê –õ—É—á—à–∏–π —Å—Ç–∞–∂—ë—Ä</h3>
        {% if best_intern %}
          <p>{{ best_intern.full_name }} ‚Äî {{ best_intern_percent }}%</p>
        {% else %}
          <p>–ü–æ–∫–∞ –Ω–µ—Ç –¥–∞–Ω–Ω—ã—Ö</p>
        {% endif %}
        <table border="1" cellpadding="6">
          <tr>
            <th>–°—Ç–∞–∂—ë—Ä</th>
            <th>–ú–∞—Ç–µ—Ä–∏–∞–ª—ã</th>
            <th>%</th>
            <th>–°—Ç–∞—Ç—É—Å</th>
          </tr>
        
          {% for stat in intern_stats %}
          <tr>
            <td>{{ stat.intern.full_name }}</td>
            <td>{{ stat.completed }} / {{ stat.total }}</td>
            <td>{{ stat.percent }}%</td>
            <td>{{ stat.status }}</td>
          </tr>
          {% endfor %}
        </table>
        <h3>üë• –ú–æ–∏ —Å—Ç–∞–∂—ë—Ä—ã</h3>

            {% if intern_stats %}
            <table class="table table-bordered mt-3">
              <thead class="table-light">
                <tr>
                  <th>–°—Ç–∞–∂—ë—Ä</th>
                  <th>–ú–∞—Ç–µ—Ä–∏–∞–ª—ã</th>
                  <th>%</th>
                  <th>–°—Ç–∞—Ç—É—Å</th>
                </tr>
              </thead>
              <tbody>
                {% for stat in intern_stats %}
                <tr>
                  <td>{{ stat.intern.full_name }}</td>
                  <td>{{ stat.completed }} / {{ stat.total }}</td>
                  <td>{{ stat.percent }}%</td>
                  <td>
                    {% if stat.status == '–ó–∞–≤–µ—Ä—à–µ–Ω–∞' %}
                      <span class="badge bg-success">{{ stat.status }}</span>
                    {% elif stat.status == '–ê–∫—Ç–∏–≤–Ω–∞' %}
                      <span class="badge bg-primary">{{ stat.status }}</span>
                    {% else %}
                      <span class="badge bg-danger">{{ stat.status }}</span>
                    {% endif %}
                  </td>
                </tr>
                {% endfor %}
              </tbody>
            </table>
            {% else %}
            <p>–£ –≤–∞—Å –ø–æ–∫–∞ –Ω–µ—Ç —Å—Ç–∞–∂—ë—Ä–æ–≤.</p>
            {% endif %}
    {% elif request.user.role == 'intern' %}
        <h3>–ú–æ—è —Å—Ç–∞–∂–∏—Ä–æ–≤–∫–∞</h3>
        {% if internship %}
            <ul>
                <li>–ü—Ä–æ–π–¥–µ–Ω–æ –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤: {{ completed_materials }} –∏–∑ {{ total_materials }}</li>
                <li>–û—Å—Ç–∞–ª–æ—Å—å –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤: {{ remaining_materials }}</li>
                <li>–û—Å—Ç–∞–≤—à–∏–µ—Å—è –¥–Ω–∏: {{ days_left }}</li>
            </ul>
        {% else %}
            <p>–£ –≤–∞—Å –Ω–µ—Ç –∞–∫—Ç–∏–≤–Ω–æ–π —Å—Ç–∞–∂–∏—Ä–æ–≤–∫–∏.</p>
        {% endif %}
    {% endif %}
</div>
{% endblock %}
